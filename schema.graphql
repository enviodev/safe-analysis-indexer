enum SafeVersion {
  V1_0_0
  V1_1_1ORV1_2_0
  V1_3_0
  V1_4_1
  V1_5_0
}

# Global statistics - single entity with id "global"
type GlobalStats {
  id: ID! # "global"
  totalSafes: Int!
  totalTransactions: Int!
  totalModuleTransactions: Int!
}

# Per-network statistics
type Network {
  id: ID! # chainId as string
  numberOfSafes: Int!
  numberOfTransactions: Int!
  numberOfModuleTransactions: Int!
  safeTransactions: [SafeTransaction!]! @derivedFrom(field: "network")
  safeModuleTransactions: [SafeModuleTransaction!]!
    @derivedFrom(field: "network")
}

# Per-version statistics
type Version {
  id: ID! # version string (e.g., "V1_3_0")
  numberOfSafes: Int!
  numberOfTransactions: Int!
  numberOfModuleTransactions: Int!
}

type Safe {
  id: ID! # chainId-address
  creationTxHash: String! @index
  creationTimestamp: BigInt! @index
  address: String! @index
  chainId: Int! @index
  owners: [String!]!
  threshold: Int!
  version: SafeVersion! @index
  safeOwners: [SafeOwner!]! @derivedFrom(field: "safe")
  initializer: String!
  safeTransactions: [SafeTransaction!]! @derivedFrom(field: "safe")
  safeModuleTransactions: [SafeModuleTransaction!]! @derivedFrom(field: "safe")
  numberOfSuccessfulExecutions: Int!
  numberOfFailedExecutions: Int!
  totalGasSpent: BigInt!
  initiator: String!
}

type Owner {
  id: ID! # owner address
  safes: [String!]!
  safeOwners: [SafeOwner!]! @derivedFrom(field: "owner")
}

type SafeOwner {
  id: ID! # ownerAddress-safeId
  owner: Owner! @index
  safe: Safe! @index
}

type SafeModuleTransaction {
  id: ID!
  safe: Safe! @index
  network: Network! @index
  chainId: Int! @index
  safeModule: String!
  to: String!
  value: BigInt!
  data: String!
  operation: BigInt!
  txHash: String! @index
  timestamp: BigInt! @index
}

type SafeTransaction {
  id: ID! # txHash-logIndex
  safe: Safe! @index
  network: Network! @index
  chainId: Int! @index
  to: String!
  value: BigInt!
  data: String!
  operation: BigInt!
  safeTxGas: BigInt!
  baseGas: BigInt!
  gasPrice: BigInt!
  gasToken: String!
  refundReceiver: String!
  signatures: String!
  nonce: BigInt!
  msgSender: String!
  threshold: Int!
  executionDate: BigInt! @index
  txHash: String! @index
}
